# ChatBot - ë²„ì „ ëª…ì„¸ì„œ v0.5.x

## ê°œìš”
ì´ ë¬¸ì„œëŠ” ChatBot ì‹œìŠ¤í…œì˜ v0.5.x ê³„ì—´ ë²„ì „ì— ëŒ€í•œ ê³µì‹ ëª…ì„¸ì„œì…ë‹ˆë‹¤. v0.4.xì˜ React í’€ìŠ¤íƒ ì‹œìŠ¤í…œì—ì„œ **API ì„¤ê³„ íŒ¨í„´ í˜ì‹ **ê³¼ **ì˜ì¡´ì„± ì£¼ì…(DI) íŒ¨í„´**ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•œ **í´ë¦° ì•„í‚¤í…ì²˜ ìµœì í™”** ë²„ì „ì…ë‹ˆë‹¤.

## ë²„ì „ ì •ë³´

| ë²„ì „ | ë¦´ë¦¬ì¦ˆ ë‚ ì§œ | ì»¤ë°‹ í•´ì‹œ | ìƒíƒœ |
|------|-------------|-----------|------|
| **v0.5.0** | 2025-05-10 | `9a896ded` | Stable |
| **v0.5.1** | 2025-05-10 | `e98c1c75` | Latest |

## v0.4.xì—ì„œ v0.5.xë¡œì˜ ì£¼ìš” ë³€ê²½ì‚¬í•­

### ì•„í‚¤í…ì²˜ íŒ¨í„´ í˜ì‹ 
- **MVC ì»¨íŠ¸ë¡¤ëŸ¬ íŒ¨í„´** â†’ **ì˜ì¡´ì„± ì£¼ì…(DI) íŒ¨í„´** ë„ì…
- **ëª¨ë…¸ë¦¬ì‹ ì„œë¹„ìŠ¤** â†’ **ëª¨ë“ˆí™”ëœ API í˜¸ì¶œ ì‹œìŠ¤í…œ**
- **ë‹¨ìˆœ ì»¨íŠ¸ë¡¤ëŸ¬** â†’ **REST API ì„¤ê³„ ê°œì„ ** ë° **API í˜¸ì¶œ ëª¨ë“ˆí™”**

### FastAPI êµ¬ì¡° ìµœì í™”
- **ë¼ìš°í„° í†µí•©** â†’ **MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ë¦¬**
- **MySQL ì»¨íŠ¸ë¡¤ëŸ¬ ì œê±°** (ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ ì •ë¦¬)
- **ì±„íŒ… ìŠ¤í‚¤ë§ˆ ì •ë¦¬** ë° **êµ¬ì¡° ê°œì„ **

### React í”„ë¡ íŠ¸ì—”ë“œ ê°œì„ 
- **CharacterChatRoom ìƒíƒœ ì´ˆê¸°í™”** ë¡œì§ ê°œì„ 
- **API í˜¸ì¶œ ëª¨ë“ˆí™”** ë° **REST API ì„¤ê³„** í–¥ìƒ
- **ì¡°ê±´ë¶€ ì‚¬ì´ë“œë°”** í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€

### ì‹ ê·œ ê¸°ëŠ¥
- **Google ì ‘ê·¼ ì„¤ì •** ë° **ì•Œë¦¼ ê¸°ëŠ¥** ìˆ˜ì •
- **ì•½ê´€ ë™ì˜ íšŒì›ê°€ì…** êµ¬í˜„ ì™„ë£Œ
- **ë©”ì¸í˜ì´ì§€** êµ¬ì„± ë° **ì‚¬ìš©ì EULA ë™ì˜** ì‹œìŠ¤í…œ ê°œì„ 

### ì œê±°ëœ ê¸°ëŠ¥
- âŒ **ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” MySQL ì»¨íŠ¸ë¡¤ëŸ¬** ì™„ì „ ì œê±°
- âŒ **ë©¤ë²„ì‹­ ê²€ì¦** ë¡œì§ ì œê±° (API ê²½ë¡œ ìˆ˜ì •)
- âŒ **ë¶ˆí•„ìš”í•œ import ë¬¸** ì •ë¦¬

## ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­
- **CPU**: ë©€í‹°ì½”ì–´ í”„ë¡œì„¸ì„œ ê¶Œì¥
- **ë©”ëª¨ë¦¬**: ìµœì†Œ 16GB RAM
- **ì €ì¥ê³µê°„**: ìµœì†Œ 30GB ì—¬ìœ  ê³µê°„
- **ë„¤íŠ¸ì›Œí¬**: ê³ ì† ì¸í„°ë„· (ì†Œì…œ ë¡œê·¸ì¸ ë° ì´ë©”ì¼ ì„œë¹„ìŠ¤)

### ì†Œí”„íŠ¸ì›¨ì–´ ìš”êµ¬ì‚¬í•­
- **ìš´ì˜ì²´ì œ**: Linux/Windows (Docker ì§€ì›)
- **Node.js**: 18.0 ì´ìƒ (React ê°œë°œ)
- **Java**: 17 ì´ìƒ (Spring Boot)
- **Python**: 3.8 ì´ìƒ (FastAPI)
- **Docker**: 20.10 ì´ìƒ
- **MySQL**: 8.0 ì´ìƒ
- **MongoDB**: 4.4 ì´ìƒ

## ì•„í‚¤í…ì²˜

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
ğŸ“¦ ChatBot v0.5.x
â”œâ”€â”€ ğŸ“ fastapi/                  # FastAPI ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“ src/                  # ì†ŒìŠ¤ ì½”ë“œ [RESTRUCTURED]
â”‚   â”‚   â”œâ”€â”€ ğŸ“ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ handlers/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ error_handler.py [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mysql_handler.py [REMOVED]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ smtp_handler.py [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ routers/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ mongo_controller/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chatbot_controller.py [SEPARATED]
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ office_controller.py [SEPARATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mysql_controller.py [REMOVED]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ smtp_controller.py [UPDATED]
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ schemas/
â”‚   â”‚   â”‚       â””â”€â”€ chat_schema.py [CLEANED]
â”‚   â”‚   â”œâ”€â”€ server.py [OPTIMIZED]
â”‚   â”‚   â””â”€â”€ .env
â”‚   â””â”€â”€ requirements.txt [UPDATED]
â”œâ”€â”€ ğŸ“ nginx/                    # ì›¹ ì„œë²„ ë° React ì•±
â”‚   â”œâ”€â”€ ğŸ“ react-frontpage/      # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Component/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Chatting/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Chatting.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Components/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatFooter.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatHeader.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatMessage.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ChatSidebar.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ Services/
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ api.ts [NEW]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ CharacterMain/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterAdd.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CharacterSwiper.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Login/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Login.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Register/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Register.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PrivacyConsentProps.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Profile/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Profile.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ SideBar/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ SideBar.tsx [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ Pages/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Home.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainPage.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterChat.tsx [UPDATED]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CharacterChatRoom.tsx [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx [UPDATED]
â”‚   â”‚   â”‚   â””â”€â”€ types.ts [UPDATED]
â”‚   â”‚   â””â”€â”€ tailwind.config.js [UPDATED]
â”‚   â””â”€â”€ nginx.conf [UPDATED]
â”œâ”€â”€ ğŸ“ springboot/               # Spring Boot ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“ src/main/java/com/TreeNut/ChatBot_Backend/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ controller/
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterController.kt [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ RoomController.kt [UPDATED]
â”‚   â”‚   â”‚   â””â”€â”€ UserController.kt [UPDATED]
â”‚   â”‚   â”œâ”€â”€ ğŸ“ model/
â”‚   â”‚   â”‚   â”œâ”€â”€ User.kt [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ Character.kt [UPDATED]
â”‚   â”‚   â”‚   â””â”€â”€ UserEulaAgreement.kt [UPDATED]
â”‚   â”‚   â”œâ”€â”€ ğŸ“ service/
â”‚   â”‚   â”‚   â”œâ”€â”€ UserService.kt [UPDATED]
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterService.kt [UPDATED]
â”‚   â”‚   â”‚   â””â”€â”€ RoomService.kt [UPDATED]
â”‚   â”‚   â””â”€â”€ ğŸ“ repository/
â”‚   â”‚       â”œâ”€â”€ UserEulaAgreementRepository.kt [UPDATED]
â”‚   â”‚       â””â”€â”€ UserRepository.kt [UPDATED]
â”‚   â””â”€â”€ build.gradle.kts [UPDATED]
â”œâ”€â”€ ğŸ“ mysql/
â”‚   â””â”€â”€ init.sql [UPDATED]
â”œâ”€â”€ docker-compose.yml [UPDATED]
â””â”€â”€ README.md [UPDATED]
```

## API ëª…ì„¸

### Spring Boot API

#### ì‚¬ìš©ì ê´€ë¦¬ API (`/api/users`)

##### POST /api/users/register
ì‚¬ìš©ì íšŒì›ê°€ì… ë° ì•½ê´€ ë™ì˜ ì²˜ë¦¬ - v0.5.x ê°œì„ 

**ìš”ì²­ í˜•ì‹:**
```json
{
  "username": "string",
  "email": "string", 
  "password": "string",
  "eulaAgreed": "boolean",
  "privacyAgreed": "boolean"
}
```

**ì‘ë‹µ í˜•ì‹:**
```json
{
  "id": "number",
  "username": "string",
  "email": "string",
  "created_at": "datetime"
}
```

##### GET /api/users/profile
ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ (í† í° ì¸ì¦ í•„ìš”)

##### PUT /api/users/profile
ì‚¬ìš©ì í”„ë¡œí•„ ìˆ˜ì •

#### ìºë¦­í„° ê´€ë¦¬ API (`/api/characters`)

##### GET /api/characters
ìºë¦­í„° ëª©ë¡ ì¡°íšŒ (ê²€ìƒ‰ ì§€ì›) - v0.5.x ìµœì í™”

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**
- `search`: ê²€ìƒ‰ì–´ (optional)
- `userId`: ì‚¬ìš©ì ID (ë³¸ì¸ ìºë¦­í„°ë§Œ ì¡°íšŒ)

##### POST /api/characters
ìºë¦­í„° ìƒì„± (ì´ë¯¸ì§€ ì—…ë¡œë“œ ì§€ì›)

##### PUT /api/characters/{id}
ìºë¦­í„° ìˆ˜ì •

##### DELETE /api/characters/{id}
ìºë¦­í„° ì‚­ì œ

#### ì±„íŒ…ë°© ê´€ë¦¬ API (`/api/rooms`)

##### POST /api/chatrooms
ì¼ë°˜ ì±„íŒ…ë°© ìƒì„± - v0.5.x ë©¤ë²„ì‹­ ê²€ì¦ ì œê±°

##### POST /api/officerooms
Office ì±„íŒ…ë°© ìƒì„± - v0.5.x API ê²½ë¡œ ìˆ˜ì •

##### GET /api/chatrooms/{id}/logs
ì±„íŒ… ë¡œê·¸ ì¡°íšŒ

##### PUT /api/chatrooms/{id}/logs
ì±„íŒ… ë¡œê·¸ ì—…ë°ì´íŠ¸

##### DELETE /api/chatrooms/{id}/logs
ì±„íŒ… ë¡œê·¸ ì‚­ì œ

### FastAPI API - v0.5.x êµ¬ì¡° ìµœì í™”

#### MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ë¦¬

##### Chatbot ì»¨íŠ¸ë¡¤ëŸ¬ (`/mongo/chatbot`)

###### POST /mongo/chatbot/create
Chatbot ì±„íŒ…ë°© ë¬¸ì„œ ìƒì„±

###### PUT /mongo/chatbot/save_log
Chatbot ì±„íŒ… ë¡œê·¸ ì €ì¥

###### PUT /mongo/chatbot/update_log
Chatbot ì±„íŒ… ë¡œê·¸ ì—…ë°ì´íŠ¸

###### POST /mongo/chatbot/load_log
Chatbot ì±„íŒ… ë¡œê·¸ ì¡°íšŒ

###### DELETE /mongo/chatbot/delete_log
Chatbot ì±„íŒ… ë¡œê·¸ ì¼ë¶€ ì‚­ì œ

###### DELETE /mongo/chatbot/delete_room
Chatbot ì±„íŒ…ë°© ì‚­ì œ

##### Office ì»¨íŠ¸ë¡¤ëŸ¬ (`/mongo/office`)

###### POST /mongo/office/create
Office ì±„íŒ…ë°© ë¬¸ì„œ ìƒì„±

###### PUT /mongo/office/save_log
Office ì±„íŒ… ë¡œê·¸ ì €ì¥

###### PUT /mongo/office/update_log
Office ì±„íŒ… ë¡œê·¸ ì—…ë°ì´íŠ¸

###### POST /mongo/office/load_log
Office ì±„íŒ… ë¡œê·¸ ì¡°íšŒ

###### DELETE /mongo/office/delete_log
Office ì±„íŒ… ë¡œê·¸ ì¼ë¶€ ì‚­ì œ

###### DELETE /mongo/office/delete_room
Office ì±„íŒ…ë°© ì‚­ì œ

#### SMTP ì»¨íŠ¸ë¡¤ëŸ¬ (`/smtp`)

##### POST /smtp/send-verification
ì´ë©”ì¼ ì¸ì¦ ì½”ë“œ ë°œì†¡

##### POST /smtp/verify-code
ì¸ì¦ ì½”ë“œ ê²€ì¦

**HTTP ìƒíƒœ ì½”ë“œ:**
- `200`: ì„±ê³µ
- `400`: ì˜ëª»ëœ ìš”ì²­
- `401`: ì¸ì¦ ì‹¤íŒ¨
- `403`: ê¶Œí•œ ì—†ìŒ
- `422`: ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨
- `500`: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### 1. FastAPI êµ¬ì¡° ê°œì„  - v0.5.x ìµœì í™”

#### MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ë¦¬ - ì„œì •í›ˆ

**chatbot_controller.py:**
```python
"""
Chatbot MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ - v0.5.x ë¶„ë¦¬
ê¸°ì¡´ í†µí•© ë¼ìš°í„°ì—ì„œ Chatbot ì „ìš© ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë¶„ë¦¬
"""
from fastapi import APIRouter, HTTPException
from utils import ChatModel, ChatError, mongodb_client

chatbot_router = APIRouter()

@chatbot_router.post("/create", summary="Chatbot ì±„íŒ…ë°© ID ìƒì„±")
async def create_chatbot_room(request: ChatModel.Id_Request):
    """
    Chatbot ì „ìš© ì±„íŒ…ë°© ìƒì„± API
    """
    try:
        document_id = await mongo_handler.create_collection(
            user_id=request.user_id,
            router="chatbot"
        )
        return {"Document ID": document_id}
    except Exception as e:
        raise ChatError.InternalServerErrorException(detail=str(e))

@chatbot_router.put("/save_log", summary="Chatbot ì±„íŒ… ì €ì¥")
async def save_chatbot_log(request: ChatModel.ChatBot_Create_Request):
    """
    Chatbot ì±„íŒ… ë¡œê·¸ ì €ì¥ API
    """
    try:
        request_data = request.model_dump()
        filtered_data = {
            key: value for key, value in request_data.items() 
            if key != 'id'
        }
        
        response_message = await mongo_handler.add_chatbot_log(
            user_id=request.user_id,
            document_id=request.id,
            new_data=filtered_data
        )
        return {"Result": response_message}
    except Exception as e:
        raise ChatError.InternalServerErrorException(detail=str(e))

# ... (ê¸°íƒ€ ë©”ì„œë“œë“¤)
```

**office_controller.py:**
```python
"""
Office MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ - v0.5.x ë¶„ë¦¬  
ê¸°ì¡´ í†µí•© ë¼ìš°í„°ì—ì„œ Office ì „ìš© ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë¶„ë¦¬
"""
from fastapi import APIRouter, HTTPException
from utils import ChatModel, ChatError, mongodb_client

office_router = APIRouter()

@office_router.post("/create", summary="Office ì±„íŒ…ë°© ID ìƒì„±")
async def create_office_room(request: ChatModel.Id_Request):
    """
    Office ì „ìš© ì±„íŒ…ë°© ìƒì„± API
    """
    try:
        document_id = await mongo_handler.create_collection(
            user_id=request.user_id,
            router="office"
        )
        return {"Document ID": document_id}
    except Exception as e:
        raise ChatError.InternalServerErrorException(detail=str(e))

# ... (ê¸°íƒ€ ë©”ì„œë“œë“¤)
```

#### ì„œë²„ êµ¬ì¡° ìµœì í™” (server.py) - ì„œì •í›ˆ

```python
"""
FastAPI ì„œë²„ - v0.5.x êµ¬ì¡° ìµœì í™”
ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ ë° ëª¨ë“ˆí™” ì ìš©
"""
from fastapi import FastAPI
from utils.routers.mongo_controller import chatbot_controller, office_controller
from utils.routers import smtp_controller

app = FastAPI(
    title="ChatBot API v0.5.x",
    description="ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ì´ ì ìš©ëœ ìµœì í™”ëœ ChatBot API",
    version="0.5.x"
)

# MongoDB ë¼ìš°í„° ë“±ë¡ (ë¶„ë¦¬ëœ ì»¨íŠ¸ë¡¤ëŸ¬)
app.include_router(
    chatbot_controller.chatbot_router,
    prefix="/mongo/chatbot",
    tags=["MongoDB Chatbot Controller"]
)

app.include_router(
    office_controller.office_router,
    prefix="/mongo/office", 
    tags=["MongoDB Office Controller"]
)

# SMTP ë¼ìš°í„° ë“±ë¡
app.include_router(
    smtp_controller.smtp_router,
    prefix="/smtp",
    tags=["SMTP Controller"]
)

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” MySQL ì»¨íŠ¸ë¡¤ëŸ¬ ì œê±°
# app.include_router(mysql_controller.mysql_router, ...) # REMOVED
```

#### ì±„íŒ… ìŠ¤í‚¤ë§ˆ ì •ë¦¬ (chat_schema.py) - ì„œì •í›ˆ

```python
"""
ì±„íŒ… ìŠ¤í‚¤ë§ˆ - v0.5.x ì •ë¦¬ ë° ìµœì í™”
ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±° ë° êµ¬ì¡° ê°œì„ 
"""
from pydantic import BaseModel, Field
from typing import Optional

# ê³µí†µ í•„ë“œ ì •ì˜ (v0.5.x ìµœì í™”)
user_id_field = Field(
    examples=["user123"],
    title="ì‚¬ìš©ì ID",
    min_length=1, max_length=50,
    description="ì‚¬ìš©ì ì‹ë³„ì"
)

id_field = Field(
    examples=["123e4567-e89b-12d3-a456-426614174000"],
    title="ì±„íŒ…ë°© ID", 
    min_length=1, max_length=36,
    description="UUID í˜•ì‹ì˜ ì±„íŒ…ë°© ì‹ë³„ì"
)

# ì •ë¦¬ëœ ìš”ì²­ ëª¨ë¸
class ChatBot_Create_Request(BaseModel):
    """
    Chatbot ì±„íŒ… ìƒì„± ìš”ì²­ - v0.5.x ì •ë¦¬
    """
    user_id: str = user_id_field
    id: str = id_field
    img_url: str = Field(..., description="ìºë¦­í„° ì´ë¯¸ì§€ URL")
    input_data: str = Field(..., min_length=1, max_length=500)
    output_data: str = Field(..., min_length=1)

class Office_Create_Request(BaseModel):
    """
    Office ì±„íŒ… ìƒì„± ìš”ì²­ - v0.5.x ì •ë¦¬
    """
    user_id: str = user_id_field
    id: str = id_field
    input_data: str = Field(..., min_length=1, max_length=500)
    output_data: str = Field(..., min_length=1)

# ê³µí†µ ì‘ë‹µ ëª¨ë¸
class Standard_Response(BaseModel):
    """
    í‘œì¤€ ì‘ë‹µ ëª¨ë¸ - v0.5.x ì‹ ê·œ
    """
    status: str = Field(default="success")
    message: str
    data: Optional[dict] = None
```

### 2. React í”„ë¡ íŠ¸ì—”ë“œ ê°œì„  - v0.5.x

#### API í˜¸ì¶œ ëª¨ë“ˆí™” (api.ts) - ì„œì •í›ˆ

```typescript
/**
 * API í˜¸ì¶œ ëª¨ë“ˆ - v0.5.x ì‹ ê·œ
 * REST API ì„¤ê³„ ê°œì„  ë° ëª¨ë“ˆí™”
 */
import axios from 'axios';

// API ê¸°ë³¸ ì„¤ì •
const api = axios.create({
  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:8080',
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// í† í° ì¸í„°ì…‰í„°
api.interceptors.request.use((config) => {
  const token = localStorage.getItem('accessToken');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// ì‘ë‹µ ì¸í„°ì…‰í„°
api.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      localStorage.removeItem('accessToken');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

// API í•¨ìˆ˜ë“¤
export const chatAPI = {
  // ì±„íŒ…ë°© ê´€ë¦¬
  createChatroom: async (data: any) => {
    const response = await api.post('/api/rooms/chatrooms', data);
    return response.data;
  },

  createOfficeroom: async (data: any) => {
    const response = await api.post('/api/rooms/officerooms', data);
    return response.data;
  },

  getChatroomLogs: async (id: string) => {
    const response = await api.get(`/api/rooms/chatrooms/${id}/logs`);
    return response.data;
  },

  updateChatroomLog: async (id: string, logData: any) => {
    const response = await api.put(`/api/rooms/chatrooms/${id}/logs`, logData);
    return response.data;
  },

  deleteChatroomLog: async (id: string, index: number) => {
    const response = await api.delete(`/api/rooms/chatrooms/${id}/logs`, {
      params: { index }
    });
    return response.data;
  },
};

export const characterAPI = {
  // ìºë¦­í„° ê´€ë¦¬
  getCharacters: async (search?: string, userId?: number) => {
    const params: any = {};
    if (search) params.search = search;
    if (userId) params.userId = userId;
    
    const response = await api.get('/api/characters', { params });
    return response.data;
  },

  createCharacter: async (data: any) => {
    const response = await api.post('/api/characters', data);
    return response.data;
  },

  updateCharacter: async (id: number, data: any) => {
    const response = await api.put(`/api/characters/${id}`, data);
    return response.data;
  },

  deleteCharacter: async (id: number) => {
    const response = await api.delete(`/api/characters/${id}`);
    return response.data;
  },
};

export const userAPI = {
  // ì‚¬ìš©ì ê´€ë¦¬
  register: async (data: any) => {
    const response = await api.post('/api/users/register', data);
    return response.data;
  },

  getProfile: async () => {
    const response = await api.get('/api/users/profile');
    return response.data;
  },

  updateProfile: async (data: any) => {
    const response = await api.put('/api/users/profile', data);
    return response.data;
  },
};

export default api;
```

#### CharacterChatRoom ìƒíƒœ ì´ˆê¸°í™” ê°œì„  - ì„œì •í›ˆ

```typescript
/**
 * CharacterChatRoom ì»´í¬ë„ŒíŠ¸ - v0.5.x ê°œì„ 
 * ìƒíƒœ ì´ˆê¸°í™” ë¡œì§ ê°œì„  ë° API í˜¸ì¶œ ëª¨ë“ˆí™” ì ìš©
 */
import React, { useState, useEffect, useCallback } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { chatAPI, characterAPI } from '../Component/Chatting/Services/api';

interface CharacterChatRoomProps {
  // ... props ì •ì˜
}

const CharacterChatRoom: React.FC<CharacterChatRoomProps> = () => {
  const { characterId } = useParams<{ characterId: string }>();
  const navigate = useNavigate();
  
  // ìƒíƒœ ì´ˆê¸°í™” ê°œì„  - v0.5.x
  const [state, setState] = useState({
    messages: [],
    isLoading: false,
    roomId: '',
    character: null,
    error: null,
  });

  // ì´ˆê¸°í™” ë¡œì§ ê°œì„ 
  const initializeRoom = useCallback(async () => {
    if (!characterId) {
      navigate('/character');
      return;
    }

    try {
      setState(prev => ({ ...prev, isLoading: true, error: null }));

      // ìºë¦­í„° ì •ë³´ ë¡œë“œ (ëª¨ë“ˆí™”ëœ API ì‚¬ìš©)
      const character = await characterAPI.getCharacters(undefined, characterId);
      
      if (!character) {
        throw new Error('ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }

      // ì±„íŒ…ë°© ìƒì„± ë˜ëŠ” ê¸°ì¡´ ì±„íŒ…ë°© ë¡œë“œ
      const roomData = await chatAPI.createChatroom({
        characterId: parseInt(characterId),
        userId: getUserId(), // ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°
      });

      setState(prev => ({
        ...prev,
        character,
        roomId: roomData.roomId,
        isLoading: false,
      }));

      // ê¸°ì¡´ ì±„íŒ… ë¡œê·¸ ë¡œë“œ
      await loadChatHistory(roomData.roomId);

    } catch (error) {
      console.error('ë°© ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
      setState(prev => ({
        ...prev,
        error: error.message,
        isLoading: false,
      }));
    }
  }, [characterId, navigate]);

  // ì±„íŒ… íˆìŠ¤í† ë¦¬ ë¡œë“œ
  const loadChatHistory = async (roomId: string) => {
    try {
      const logs = await chatAPI.getChatroomLogs(roomId);
      setState(prev => ({
        ...prev,
        messages: logs || [],
      }));
    } catch (error) {
      console.error('ì±„íŒ… íˆìŠ¤í† ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', error);
    }
  };

  // ë©”ì‹œì§€ ì „ì†¡ í•¸ë“¤ëŸ¬
  const handleSendMessage = async (content: string) => {
    if (!content.trim() || !state.roomId) return;

    try {
      setState(prev => ({ ...prev, isLoading: true }));

      const newMessage = {
        content,
        timestamp: new Date().toISOString(),
        type: 'user',
      };

      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
      setState(prev => ({
        ...prev,
        messages: [...prev.messages, newMessage],
      }));

      // ì„œë²„ì— ë©”ì‹œì§€ ì €ì¥
      await chatAPI.updateChatroomLog(state.roomId, {
        input_data: content,
        timestamp: newMessage.timestamp,
      });

      // AI ì‘ë‹µ ìš”ì²­ (êµ¬í˜„ í•„ìš”)
      // const aiResponse = await getAIResponse(content, state.character);
      
    } catch (error) {
      console.error('ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', error);
    } finally {
      setState(prev => ({ ...prev, isLoading: false }));
    }
  };

  useEffect(() => {
    initializeRoom();
  }, [initializeRoom]);

  // ì—ëŸ¬ ì²˜ë¦¬
  if (state.error) {
    return (
      <div className="error-container">
        <h2>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h2>
        <p>{state.error}</p>
        <button onClick={() => navigate('/character')}>
          ìºë¦­í„° ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        </button>
      </div>
    );
  }

  // ë¡œë”© ì²˜ë¦¬
  if (state.isLoading && !state.character) {
    return (
      <div className="loading-container">
        <div className="loading-spinner">ë¡œë”© ì¤‘...</div>
      </div>
    );
  }

  return (
    <div className="character-chat-room">
      {/* ì±„íŒ… UI ë Œë”ë§ */}
    </div>
  );
};

export default CharacterChatRoom;
```

#### ì¡°ê±´ë¶€ ì‚¬ì´ë“œë°” ì‹œìŠ¤í…œ - ì„œì •í›ˆ

```typescript
/**
 * App.tsx - v0.5.x ë¼ìš°íŒ… ê°œì„ 
 * ì¡°ê±´ë¶€ ì‚¬ì´ë“œë°” í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€
 */
import React from 'react';
import { BrowserRouter as Router, Routes, Route, useLocation } from 'react-router-dom';
import SideBar from './Component/SideBar/SideBar';

// ì‚¬ì´ë“œë°”ë¥¼ ìˆ¨ê¸¸ ê²½ë¡œë“¤
const SIDEBAR_HIDDEN_PATHS = [
  '/login',
  '/register',
  '/',
];

const AppContent: React.FC = () => {
  const location = useLocation();
  
  // í˜„ì¬ ê²½ë¡œì—ì„œ ì‚¬ì´ë“œë°”ë¥¼ í‘œì‹œí• ì§€ ê²°ì •
  const shouldShowSidebar = !SIDEBAR_HIDDEN_PATHS.includes(location.pathname);

  return (
    <div className="app-container">
      {shouldShowSidebar && <SideBar />}
      <div className={`main-content ${shouldShowSidebar ? 'with-sidebar' : 'full-width'}`}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/main" element={<MainPage />} />
          <Route path="/login" element={<Login />} />
          <Route path="/register" element={<Register />} />
          <Route path="/profile" element={<Profile />} />
          <Route path="/character" element={<CharacterChat />} />
          <Route path="/character/:characterId" element={<CharacterChatRoom />} />
        </Routes>
      </div>
    </div>
  );
};

const App: React.FC = () => {
  return (
    <Router>
      <AppContent />
    </Router>
  );
};

export default App;
```

### 3. Spring Boot ë°±ì—”ë“œ ê°œì„  - v0.5.x

#### RoomController ë©¤ë²„ì‹­ ê²€ì¦ ì œê±° - ì„œì •í›ˆ

```kotlin
/**
 * RoomController - v0.5.x ìµœì í™”
 * ë©¤ë²„ì‹­ ê²€ì¦ ì œê±° ë° API ê²½ë¡œ ìˆ˜ì •
 */
@RestController
@RequestMapping("/api/rooms")
class RoomController(
    private val roomService: RoomService
) {
    
    @PostMapping("/chatrooms")
    fun createChatroom(@RequestBody chatroom: Chatroom): ResponseEntity<Chatroom> {
        // v0.5.x: ë©¤ë²„ì‹­ ê²€ì¦ ë¡œì§ ì œê±°
        // ì´ì „ ë²„ì „ì˜ membershipService.validateUser() ì œê±°
        
        return ResponseEntity.ok(roomService.createChatroom(chatroom))
    }
    
    @PostMapping("/officerooms")
    fun createOfficeroom(@RequestBody officeroom: Officeroom): ResponseEntity<Officeroom> {
        // v0.5.x: ë©¤ë²„ì‹­ ê²€ì¦ ë¡œì§ ì œê±°
        // API ê²½ë¡œ ì •ë¦¬ ë° ë‹¨ìˆœí™”
        
        return ResponseEntity.ok(roomService.createOfficeroom(officeroom))
    }
    
    @GetMapping("/chatrooms/{id}/logs")
    fun getChatroomLogs(@PathVariable id: String): ResponseEntity<List<Any>> {
        return ResponseEntity.ok(roomService.getChatroomLogs(id))
    }
    
    @PutMapping("/chatrooms/{id}/logs")
    fun updateChatroomLog(
        @PathVariable id: String,
        @RequestBody logData: Map<String, Any>
    ): ResponseEntity<String> {
        return ResponseEntity.ok(roomService.updateChatroomLog(id, logData))
    }
    
    @DeleteMapping("/chatrooms/{id}/logs")
    fun deleteChatroomLog(
        @PathVariable id: String,
        @RequestParam index: Int
    ): ResponseEntity<String> {
        return ResponseEntity.ok(roomService.deleteChatroomLog(id, index))
    }
    
    @DeleteMapping("/officerooms/{id}")
    fun deleteOfficeroom(@PathVariable id: String): ResponseEntity<Void> {
        roomService.deleteOfficeroom(id)
        return ResponseEntity.noContent().build()
    }
}
```

#### CharacterController ê°œì„  - ì„œì •í›ˆ

```kotlin
/**
 * CharacterController - v0.5.x ê°œì„ 
 * API ì„¤ê³„ ìµœì í™” ë° ì‘ë‹µ êµ¬ì¡° ê°œì„ 
 */
@RestController
@RequestMapping("/api/characters")
class CharacterController(
    private val characterService: CharacterService,
    private val tokenAuth: TokenAuth
) {
    
    @GetMapping
    fun getAllCharacters(
        @RequestParam(required = false) search: String?,
        @RequestParam(required = false) userId: Long?
    ): ResponseEntity<List<CharacterResponse>> {
        // v0.5.x: ì‘ë‹µ êµ¬ì¡° ìµœì í™”
        val characters = when {
            search != null -> characterService.searchCharacters(search)
            userId != null -> characterService.findByUserId(userId)
            else -> characterService.findAllPublic()
        }
        
        return ResponseEntity.ok(
            characters.map { CharacterResponse.from(it) }
        )
    }
    
    @PostMapping
    fun createCharacter(
        @RequestBody request: CharacterCreateRequest,
        @RequestHeader("Authorization") token: String
    ): ResponseEntity<ApiResponse<CharacterResponse>> {
        // v0.5.x: í‘œì¤€í™”ëœ ì‘ë‹µ êµ¬ì¡°
        tokenAuth.validateToken(token)
        val userId = tokenAuth.getUserIdFromToken(token)
        
        val character = characterService.createCharacter(request, userId)
        
        return ResponseEntity.ok(
            ApiResponse.success(
                data = CharacterResponse.from(character),
                message = "ìºë¦­í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."
            )
        )
    }
    
    // ... ê¸°íƒ€ ë©”ì„œë“œë“¤
}

// v0.5.x: í‘œì¤€í™”ëœ API ì‘ë‹µ ëª¨ë¸
data class ApiResponse<T>(
    val status: String,
    val message: String,
    val data: T? = null,
    val errors: List<String>? = null
) {
    companion object {
        fun <T> success(data: T? = null, message: String = "ì„±ê³µ"): ApiResponse<T> {
            return ApiResponse(
                status = "success",
                message = message,
                data = data
            )
        }
        
        fun <T> error(message: String, errors: List<String>? = null): ApiResponse<T> {
            return ApiResponse(
                status = "error", 
                message = message,
                errors = errors
            )
        }
    }
}
```

## ì„¤ì¹˜ ë° ì„¤ì •

### Docker ê¸°ë°˜ ë°°í¬ ì‹œìŠ¤í…œ - v0.5.x ìµœì í™”

#### ë¹ ë¥¸ ì‹œì‘
```bash
# 1. ë¦¬í¬ì§€í† ë¦¬ í´ë¡ 
git clone https://github.com/TreeNut-KR/ChatBot.git
cd ChatBot

# 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤, API í‚¤, SMTP ì„¤ì •

# 3. React ì•± ë¹Œë“œ (v0.5.x ìµœì í™”)
cd nginx/react-frontpage
npm install
npm run build
cd ../..

# 4. ì»¨í…Œì´ë„ˆ ë¹Œë“œ ë° ì‹¤í–‰
docker-compose up --build

# 5. API í…ŒìŠ¤íŠ¸ (v0.5.x ìµœì í™”ëœ ì—”ë“œí¬ì¸íŠ¸)
# ë¶„ë¦¬ëœ MongoDB ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸
curl -X POST "http://localhost:8000/mongo/chatbot/create" \
  -H "Content-Type: application/json" \
  -d '{"user_id": "test_user"}'

curl -X POST "http://localhost:8000/mongo/office/create" \
  -H "Content-Type: application/json" \
  -d '{"user_id": "test_user"}'
```

#### ì„œë¹„ìŠ¤ í¬íŠ¸ ì„¤ì •
- **nginx (React ì•±)**: 80
- **Spring Boot**: 8080 
- **FastAPI**: 8000
- **MySQL**: 3308
- **MongoDB**: 27017

## ìš´ì˜ ê°€ì´ë“œ

### í™˜ê²½ ì„¤ì •
1. **ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´** ì´í•´ ë° ì ìš©
2. **ë¶„ë¦¬ëœ MongoDB ì»¨íŠ¸ë¡¤ëŸ¬** ì„¤ì • í™•ì¸
3. **API ëª¨ë“ˆí™”** ì‹œìŠ¤í…œ í™œìš©
4. **ì¡°ê±´ë¶€ ì‚¬ì´ë“œë°”** ì„¤ì •

### ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸
- **ë¶„ë¦¬ëœ ì»¨íŠ¸ë¡¤ëŸ¬** ë³„ API ì‚¬ìš©ëŸ‰
- **ëª¨ë“ˆí™”ëœ API í˜¸ì¶œ** ì„±ëŠ¥
- **ìƒíƒœ ì´ˆê¸°í™”** ë¡œì§ ì•ˆì •ì„±
- **ì¡°ê±´ë¶€ UI ë Œë”ë§** ì„±ëŠ¥

### ë¬¸ì œ í•´ê²°
- **ì˜ì¡´ì„± ì£¼ì… ì˜¤ë¥˜**: ëª¨ë“ˆ ì„í¬íŠ¸ ê²½ë¡œ ë° ìˆœí™˜ ì°¸ì¡° í™•ì¸
- **API ëª¨ë“ˆí™” ì‹¤íŒ¨**: axios ì„¤ì • ë° í† í° ì¸í„°ì…‰í„° í™•ì¸
- **ìƒíƒœ ì´ˆê¸°í™” ì‹¤íŒ¨**: useCallback ì˜ì¡´ì„± ë°°ì—´ í™•ì¸
- **ì‚¬ì´ë“œë°” ë Œë”ë§ ì˜¤ë¥˜**: ê²½ë¡œ ì¡°ê±´ ë° CSS í´ë˜ìŠ¤ í™•ì¸

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ê°•í™”ëœ ë³´ì•ˆ ê¸°ëŠ¥
- **ì˜ì¡´ì„± ì£¼ì…**: ëª¨ë“ˆ ê°„ ì•ˆì „í•œ ì˜ì¡´ì„± ê´€ë¦¬
- **API ëª¨ë“ˆí™”**: ì¤‘ì•™ì§‘ì¤‘ì‹ ì¸ì¦ ë° ì—ëŸ¬ ì²˜ë¦¬
- **í† í° ì¸í„°ì…‰í„°**: ìë™ í† í° ê°±ì‹  ë° ë§Œë£Œ ì²˜ë¦¬
- **ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ë¦¬**: ì„œë¹„ìŠ¤ë³„ ë…ë¦½ì  ë³´ì•ˆ ì •ì±…

### API ë³´ì•ˆ ê°•í™”
- **í‘œì¤€í™”ëœ ì‘ë‹µ**: ì¼ê´€ëœ API ì‘ë‹µ êµ¬ì¡°
- **ì¤‘ì•™ì§‘ì¤‘ì‹ ì—ëŸ¬ ì²˜ë¦¬**: axios ì¸í„°ì…‰í„° ê¸°ë°˜
- **í† í° ìë™ ê´€ë¦¬**: localStorageì™€ HTTP í—¤ë” ë™ê¸°í™”
- **ê²½ë¡œë³„ ì ‘ê·¼ ì œì–´**: ì¡°ê±´ë¶€ ë¼ìš°íŒ… ë°